<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <meta name="description" content="github authentication">
    <meta name="author" content="Christina Bögh">


    <title>Innlämning 3</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <style>#welcomeTitle {display:none;} *{color:#E8D4B4;}</style>

</head>

<body class="center" style="background-color:#F6FFE5;">
    <div class="container center" style="min-width:30em;">
        <div class="row" style="background-color:#8277E8; margin:0; border-radius: 4px; min-width:30em;">
            <div class="col-md-12 col-md-12 col-sm-12 col-xs-12" id="logInWindow" style="min-width:30em; background-color:#FF5980;">
			    <span id="loginTitle" style="color:#C9FFF5;"><strong>Click the buttn to log into Github</strong></span>
                <span id="welcomeTitle"><strong>You are now logged in</strong></span>
                <br>
                <button onclick = "githubSignin()" id="login">Github Signin</button>
                <br>
                <button onclick = "githubSignout()" id="logout">Github Signout</button>
            </div>
            <!-- end col -->
            
            <div class="col-md-12 col-md-12 col-sm-12 col-xs-12" id="content" style="min-width:30em;">
                 <div class="quickstart-user-details-container">
                     
                    Firebase sign-in status: <span id="loginStatus">Unknown</span>
                     
                    <div>Firebase auth <code>currentUser</code> object value:</div>
                     
                    <pre><code id="quickstart-account-details">null</code></pre>
                     
                    <div>GitHub OAuth Access Token:</div>
                     
                    <pre><code id="quickstart-oauthtoken">null</code></pre>
                     
                  </div>
            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
    </div>
    <!-- end container -->

    
<!-- My database link -->
<script src="https://www.gstatic.com/firebasejs/3.7.3/firebase.js"></script>
<script>

</script>

<script>
  // Initialize Firebase
var ref = new Firebase("https://githubauth-c6d8b.firebaseio.com/");
    
  var config = {
    apiKey: "AIzaSyDPoGgZRIb77rztoNrl2NaGARKWVLdQZtU",
    authDomain: "githubauth-c6d8b.firebaseapp.com",
    databaseURL: "https://githubauth-c6d8b.firebaseio.com",
    storageBucket: "githubauth-c6d8b.appspot.com",
    messagingSenderId: "918393670030"
  };
    
  firebase.initializeApp(config);
</script>
</script>

<script>
    // object for authentication
var provider = new firebase.auth.GithubAuthProvider();

    
    //function to sign in, on button click.
function githubSignin() {

    
/* pop-up */ 

firebase.auth().signInWithPopup(provider)
.then(function(result) {
    
    let user = result.user;
    
    let element = document.getElementById('login');
        element.disabled = true;  // stänger av ett klickbart element
        element.style.display = 'none';
    let title = document.getElementById('loginTitle');
        title.style.display = 'none';   
    let loggedIn = document.getElementById('result');
        loggedIn.innerHTML = result;
    
    console.log(result);
    console.log('success: ' + user);
}); 
};
    
    
    


    //function to sign out, on button click.
function githubSignout(){
    
    //logout fromt he database.
   firebase.auth().signOut()
   
   .then(function() {
      console.log('Signout successful!')
      
      // if problem:
   }, function(error) {
      console.log('Signout failed')
   });

    
    // to show or hide elements when signout button is clicked.
    
    let element = document.getElementById('login');
    element.disabled = false;  
    element.style.display = 'block';
    
    let welcome = document.getElementById('welcomeTitle');
    welcome.style.display = 'none';
};
</script>

</body>

</html>


/* ************************************************************ */

/* re-load1 */
/*
firebase.auth().getRedirectResult().then(function(result) {
  if (result.credential) {
      
    // This gives you a GitHub Access Token. You can use it to access the GitHub API.
    var token = result.credential.accessToken;
  }
    
  // The signed-in user info.
  var user = result.user;
    
    let element = document.getElementById('login');
        element.disabled = true;  // stänger av ett klickbart element
        element.style.display = 'none';
    let title = document.getElementById('loginTitle');
        title.style.display = 'none';   
    let loggedIn = document.getElementById('result');
        loggedIn.innerHTML = result;
    
    console.log(result);
    console.log('success: ' + user);
    
    
}).catch(function(error) {
console.log(error);
  // Handle Errors here.
  var errorCode = error.code;
  var errorMessage = error.message;
  // The email of the user's account used.
  var email = error.email;
  // The firebase.auth.AuthCredential type that was used.
  var credential = error.credential;
  // ...
});
*/
};

