<!DOCTYPE html>
<html>

<head>
	<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
	
	<title>page2</title>
		
	<!--[if IE]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
<style>
    
    #values {border-style: solid}
	#1 {border-style: solid}
	#2 {border-style: solid}
    #3 {border-style: solid}
    #4 {border-style: solid}
    #5 {border-style: solid}
  
</style>
    
<script>
    
    //foursquare needs id!
    //client id:RHPTHZQRVD1O3M0AX3SREE4QJWLPPAEIFJAOGZHTTWT12A4W
    // client secret: U4SDRN4NDPX3EZSXSIK44ZZCWIT01FGS54PE3EGF2VSYD53X
    
    // Google needs id!
    // AIzaSyDqlDUN18gi5vXn7lqtHJXUCwnqmKkjNXk
    
		window.addEventListener('load', function() {   // so shit loads and then runs.
            
            
			let button = document.getElementById('button');
			button.addEventListener('click', function() {
                
				// DOM-element to display results in.
				let status = document.getElementById('1');
				let res = document.getElementById('2');
                let all_json = document.getElementById('3');
                
                
				
				
// URL Foursquare
				let url = 'https://api.foursquare.com/v2/venues/search?';
                
                //date
                url += 'v=' + '20170216' + '&';
                
                // coordinates
                var lat = 41.878114;
                var lng = -87.629798;
				url += 'll=' + lat + ',' + lng + '&';

                //radius
                let radius = 200;
                url += 'radius=' + radius + '&';
                
                //what
                let categoryId = 'restaurant' + '&';
				url += 'query=' + categoryId;
                
                //identification
                url += 'client_id=RHPTHZQRVD1O3M0AX3SREE4QJWLPPAEIFJAOGZHTTWT12A4W&client_secret=U4SDRN4NDPX3EZSXSIK44ZZCWIT01FGS54PE3EGF2VSYD53X';
                
				// AJAX request Foursquare
				let ajax = new XMLHttpRequest();
				ajax.open('get', url);
				ajax.onreadystatechange = function() {
					if( ajax.status == 200 && ajax.readyState == 4 ) {
                        
						// AJAX success
						let json = JSON.parse(ajax.responseText);
						status.innerHTML = 'foursquare good';

                        //res.innerHTML = 'response is: ' + json.response.venues ;
                        
                        for (i = 0; i < json.response.venues.length; i++ ) {
                            
                        var node = document.createElement("LI");                 
                        var textnode = document.createTextNode('name: ' + json.response.venues[i].name + '. Adress: ' + json.response.venues[i].location.address + '. Count: ' + json.response.venues[i].stats.checkinsCount);         
                        node.appendChild(textnode);                              
                        document.getElementById("list").appendChild(node);     
                        }
                        
                        
						//console.log(`${ajax.responseText}`);
                        all_json.innerHTML = ajax.responseText;
					}
					else if( ajax.status != 200 ) {
						status.innerHTML = 'Error';
					}
				};
				ajax.send();
                
                

			});

		});
                  
	</script>

    <script>
   
        var lat = 41.878114;           
        var lng = -87.629798;
        
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('5'), {
          center: {lat, lng},
          zoom: 8
        
        });
          let status2 = document.getElementById('4');
          status2.innerHTML = ' Google good';
      }
            
    </script>
        <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqlDUN18gi5vXn7lqtHJXUCwnqmKkjNXk&callback=initMap">
    </script>

<body>

  

	<div id="page-wrap">

        <header>
		 <h2>Foursquare -- Google</h2>
		</header>
		
		<section id="main-content">
            
            <div id='values'> Testvalues: <br>
                Chicago <br>
                lat = 41.878114 <br>
                long = -87.629798 <br>
                categoryId = 'restaurant'
            </div>
     <button id="button" onclick="initMap()">Click me</button>
            <div id="1">
                status Foursquare
            </div>
            <div id="4">
                status Google
            </div>
            <div id="2">
                result Foursquare
                <ul id="list"></ul>
            </div>
                <div id="5" style="max-width:50%;height:400px;"> result Google </div>
            
            <div id="3">
                json Foursquare
            </div>

            
		</section>
	
	</div>


</body>

</html>
