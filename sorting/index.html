<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <meta name="description" content="chat">
    <meta name="author" content="Christina Bögh">


    <title>Innlämning 4</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<script src="paging.js"></script>

    <style>
 button {
            background-color: #813772;
            color: white;
            border-bottom-color: black;
            border: 1px;
            border-radius: 4px;
            padding: 0.5em 0.5em;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 1em;
            margin: 2px 1px;
            
        };
        td {
            background-color: #062F4F;
            margin: 12px 12px 12px 12px;
            padding: 12px 12px 12px 12px;
        }

        #items {
            border-radius: 4px;
        }

        table.items {
            border-collapse: separate;
            border-spacing: 10px;
            *border-collapse: expression('separate', cellSpacing='10px');
        }
p{color:white;}
.inputs{color:white;}


table {
  border-collapse: separate;
  background:#fff;
  @include border-radius(5px);
  margin:50px auto;
  @include box-shadow(0px 0px 5px rgba(0,0,0,0.3));
}

thead {
  @include border-radius(5px);
}

thead th {
 
  font-size:16px;
  font-weight:400;
  color:Black;
  @include text-shadow(1px 1px 0px rgba(0,0,0,0.5));
  text-align:left;
  padding:20px;
  @include background-image(linear-gradient(#646f7f, #4a5564));
  border-top:1px solid #858d99;
  
  &:first-child {
   @include border-top-left-radius(5px); 
  }

  &:last-child {
    @include border-top-right-radius(5px); 
  }
}

tbody tr td {
  font-family: 'Open Sans', sans-serif;
  font-weight:400;
  color:#5f6062;
  font-size:13px;
  padding:20px 20px 20px 20px;
  border-bottom:1px solid #e0e0e0;
  
}

tbody tr:nth-child(2n) {
  background:#f0f3f5;
}

tbody tr:last-child td {
  border-bottom:none;
  &:first-child {
    @include border-bottom-left-radius(5px);
  }
  &:last-child {
    @include border-bottom-right-radius(5px);
  }
}

tbody:hover > tr td {
  @include opacity(0.5);

}

tbody:hover > tr:hover td {
  @include text-shadow(none);
  color:#2d2d2d;
  @include opacity(1.0);
}
    </style>

</head>

<body class="center">

    <div class="container center" style="min-width:30em;">

        <div class="row" style="background-color:#062F4F; padding:0.5em; margin:0.5em; border-radius: 4px; min-width:30em;">
            <div class="col-md-12 col-md-12 col-sm-12 col-xs-12" style="min-width:30em;">
  <label for="inputs" style="margin:0.6em; padding:0.6em;" > <h2 style="color:#813772;">Add</h2></label><br>
                    <input class ="inputs" id="inputName" type="text" placeholder="Name" />
                    <input class ="inputs" id="inputType" type="text" placeholder="Type" />
                    <input class ="inputs" id="inputCount" type="text" placeholder="Count" />
                    <input class ="inputs" id="inputPrice" type="text" placeholder="Price" />
                    <button class ="inputs" id="addButton">Add</button>
                

            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
        <div class="row" style="background-color:#062F4F; padding:0.5em; margin:0.5em; border-radius: 4px; min-width:30em;">
            <div class="col-md-12 col-md-12 col-sm-12 col-xs-12" style="min-width:30em;">
               <label for="inputs" style="margin:0.6em; padding:0.6em;" > <h2 style="color:#813772;">Sort</h2></label><br>
			
                    <button class ="inputs" id="sortname">by name</button>
                    <button class ="inputs" id="sorttype">by type</button>
                    <button class ="inputs" id="sortcount">by amount</button>
                    <button class ="inputs" id="sortprice">by price</button>
                    <input class ="inputs" type='text' id='howmany' />
                
            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
        <div class="row" style="background-color:#062F4F; padding:0.5em; margin:0.5em; border-radius: 4px; min-width:30em;">
            <div class="col-md-12 col-md-12 col-sm-12 col-xs-12" style="min-width:30em;">
                
                    <label for="items" style="margin:0.6em; padding:0.6em;" > <h2 style="color:#813772;">Stored Items</h2></label>
			
                    <table id="items" cellspacing=12 style="margin:0.6em; padding:0.6em;">

			    <thead>
				<tr>
				    <th>Name</th>
				    <th>Type</th>
				    <th>Amount</th>
				    <th>Price</th>
				</tr>
			    </thead>			

		    </table>
			<button onclick="nextList()" id="nextItems">Next</button>
                
            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
    </div>
    <!-- end container -->




    <script>
var lastItem = '';

        window.addEventListener('load', function() { //shit has to load




            let name = document.getElementById('inputName');
            let type = document.getElementById('inputType');
            let amount = document.getElementById('inputCount');
            let price = document.getElementById('inputPrice');
            let addButton = document.getElementById('addButton');



            addButton.addEventListener('click', function(event) { // button push add

                firebase.database().ref('items/').push({
                    name: name.value,
                    type: type.value,
                    amount: Number(amount.value),
                    price: Number(price.value)
                });
            });
            firebase.database().ref('items/').on('child_added', function(snapshot, prevChildKey) {

                let data = snapshot.val();
                addItem(data);

		
            });

            function addItem(data) {
console.log(data) ;
                let items = document.getElementById('items');
                let tr = document.createElement('tr');
                tr.style.margin = '1em';
		tr.style.color = 'white';
		
                tr.innerHTML = `
			<td >${data.name}</td> 
			<td>${data.type}</td> 
			<td>${data.amount}</td>
			<td>${data.price}</td> 
			`;
                items.appendChild(tr);
            }


            let sortName = document.getElementById('sortname');
            let sortType = document.getElementById('sorttype');
            let SortCount = document.getElementById('sortcount');
            let SortPrice = document.getElementById('sortprice');
            let howMany = document.getElementById('howmany');

            function sortFunction(button, sortKey) {
                button.addEventListener('click', function(event) {
                    items.innerHTML = '';

                    firebase.database().ref('items/').orderByChild(sortKey)
                        .once('value', function(snapshot) {
                            snapshot.forEach(items => {
                                addItem(items.val());


                            })
                        });
                })
            }
            sortFunction(sortName, 'name');
            sortFunction(sortType, 'type');
            sortFunction(sortcount, 'count');
            sortFunction(sortprice, 'price');

            howMany.addEventListener('keypress', function(event) {
		

                if (event.keyCode == 13) {
                    let many = Number(howmany.value);
                    items.innerHTML = '';

                    if (isNaN(many)) {
                        console.log('no good');
                    } else {
                        firebase.database().ref('items/').limitToFirst(many)
                            .once('value', function(snapshot) {
                                snapshot.forEach(items => {
                                    addItem(items.val());
					
					

						
                                })
                            });
                    }

                };
            });







   
    }); // end loader
    </script>

    <script src="https://www.gstatic.com/firebasejs/3.7.3/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyA9MPqB2yn2TZWAprYguFmg9gLCUiog31s",
            authDomain: "sortingshop.firebaseapp.com",
            databaseURL: "https://sortingshop.firebaseio.com",
            storageBucket: "sortingshop.appspot.com",
            messagingSenderId: "968890666078"
        };
        firebase.initializeApp(config);
    </script>

</body>

</html>
