<!DOCTYPE html>
<html lang="en">
<!-- #42313A   #6c2d2c   #9f4636  #f1dcc9 -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>innl√§mning 1</title>

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!--API-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <!--Bootstrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    
    <!-- jquery -->
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

    <!-- scripts -->
    <script src="view_book.js"></script>
    <script src="add_book.js"></script>
    <script src="statusbar.js"></script>
    <script src="google_books.js"></script>
    <script src="delete_item.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


    <script>
        // server not responding function - popup annoyance
        function myFunction() {
            confirm("The server didnt respond. Please Try again!");
        }
    </script>

<script>
    // fcuntion to switch from one tab to another
    
function openCity(cityName) {
    var i;
    var x = document.getElementsByClassName("city");
    for (i = 0; i < x.length; i++) {
       x[i].style.display = "none";  
    }
    document.getElementById(cityName).style.display = "block";  
}
</script>
    
    <script>
      window.addEventListener('load', function() { // so shit loads and then runs.
          
    function getEventTarget(e) { 
    e = e || window.event;
	something = e.target || e.srcElement;
    return e.target || e.srcElement; 
}
    
    var ul = document.getElementById('book_reviews');
	ul.onclick = function(event) {
	    var target = getEventTarget(event);
	    var result = target.innerHTML;
		
	    console.log(result);
        
        
        substring = "by";
        let wow = result.indexOf(substring);
	    console.log(wow);
        
        let titleH = result.substring((0),(wow-1));
            
        
        console.log(titleH);
        let authorH = result.substring((wow+3),(result.length));
        console.log(authorH);
        
        
                // url to access server
                let url = 'https://www.forverkliga.se/JavaScript/api/crud.php?op=insert&key=sHx2P';
                
                url+= '&title=' + titleH + '&author=' + authorH;
                console.log(url);
                
                // AJAX request 
                let ajax = new XMLHttpRequest();

                ajax.open('post', url);
  
                ajax.onreadystatechange = function() {
                    
                let status = '';

                    if (ajax.status == 200 && ajax.readyState == 4) {
                        //parse string to object
                        let json = JSON.parse(ajax.responseText);

                        // check is status = error
                        if (json.status !== 'error') {
// status message - Server OK
                           
                         target.style.backgroundColor = '#5cb85c';   
                            
                      printm('The book: '+titleH+' by '+authorH+' was added.');
       
                        } else {
// status message - Server Bad
                            
                            printm(json.status +', ' + json.message);
                            
                        }

                    } else if (ajax.status != 200) {  
// status message - Server Bad
                             console.log(json);
                             printm('server error');
                             
                    }

                };  //end ajax
            ajax.send(); 
          
      }; // end listener
                 
      });
 
               

    </script>


</head>

<body style="margin-left:20px; margin-right:20px; ">
    
    <div class="container-fluid" style="margin-left:20px; margin-right:20px; min-width:450px;">
        <!-- title and intro-->

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12" style=" background-color:#42313A; vertical-align: bottom; height:10em; ">
                <div style=" float:middle; text-align:center;">
                    <h3 style="color:white;">Great books</h3>
                    <button onclick="location.reload();">Reload page</button>
                </div>
            </div>
            <!--Col end-->
        </div>
        <!--row end-->

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 " style="color:white; background-color:#42313A; vertical-align: bottom; height: 100%;">
                <p>You can here add a new book. View all the books currently stored in the database and delete a book.</p>
                <br>
                <p>
                    <!--status-->
                    
                    <section id="status_field_v"><pre>Server Status : All good.</pre></section>
                </p>
            </div>
            <!--Col end-->
        </div>
        <!--row end-->
    </div>
    <!--Container end-->
    
    <br>
<div class="container-fluid" style="margin-left:20px; margin-right:20px; min-width:450px;">
        <!--menu-->
    <div class="row" style="min-height:5em; background-color:#42313A; vertical-align: bottom;">
        <div class="col-lg-12 col-md-12 col-sm-12" style=" background-color:#42313A; vertical-align: bottom;">
<div id="centeredmenu">
<span>Menu</span>
<ul>
          <li><a href="#" onclick="openCity('addBook')">Add a new book</a></li>
          <li><a href="#" onclick="openCity('searchBook')">Search for a book</a></li>
          <li><a href="#" onclick="openCity('viewBook')">View saved books</a></li>
</div> <!--center end-->
        </div> <!--Col end-->
    </div> <!--row end-->
</div><!--Container end-->
            
    
    
<div id="addBook" class="w3-container city"> <!-- START ADD -->
      <div class="container-fluid" style="margin-left:20px; margin-right:20px; min-width:450px; ">
        <!-- Book title and author fields and buttons for add and search-->

        <div class="row" style=" background-color:#42313A;">
            <div class="col-lg-5 col-md-12 col-sm-12" style=" background-color:#6c2d2c; vertical-align: bottom; min-height:25em;">
                <h2 style="border-radius: 8px; color:white; padding:5px; height:2em; background-color:#6c2d2c;">Add a new book</h2>
                <h5 style="color:white;">You can here add a specific book to the database. <br>Specify title / author and press the Add button.</h5>
                
                
                <label id='labelA' for="author">Author</label>
                <input type="text" class="form-control"  placeholder="Mary Peterson" id="author">
                
                
                <label id='labelB' for="title">Title</label>
                <input type="text" class="form-control" placeholder="Snail has lunch" id="title" height="200px">
                
                <button type="button" class="btn btn-success btn-sm" id='button' ><strong>+</strong></button>
                
                
                <!-- <label for="title" style=" border-radius: 8px; color:white; padding:5px; height:2em; background-color:#6c2d2c;">The last book you have added:</label>
                <section id="status_field_selection" style="color:white;"></section>
                -->
                
            </div>
            <!--Col end-->
            
           
            
        </div>
        <!--row end-->
     
    </div>
    <!--Container end-->
</div> <!-- Add end -->

<div id="searchBook" class="w3-container city" style="display:none"> <!-- START SEARCH -->
      <div class="container-fluid" style="margin-left:20px; margin-right:20px; min-width:450px;">
        <!-- Book title and author fields and buttons for add and search-->

        <div class="row" style=" background-color:#42313A;">
            <div class="col-lg-5 col-md-12 col-sm-12" style=" background-color:#6c2d2c; vertical-align: bottom; min-height:25em;">
            
                <h2 style="border-radius: 8px; color:white; padding:5px; height:2em; background-color:#6c2d2c;">Search for a book</h2>
                <h5 style="color:white;">If you are unsure about a title or author, search in Googles book database. <br>Specify title or author (or both) and press the search button. </h5>
                
                <label id='labelC' for="author">Author</label>
                <input type="text" class="form-control" style="max-width=40px;" placeholder="Mary Peterson" id="S_author">
                
                <label id='labelD' for="title">Title</label>
                <input type="text" style="max-width=40px;" class="form-control" placeholder="Snail has lunch" id="S_title" height="200px">
                
                <button type="button" class="btn-success btn-sm" onclick="mySecret('book_reviews')" id='search_g'>SEARCH</button>
        
            </div>
            <!--Col end-->
            
            <div class="col-lg-7 col-md-12 col-sm-12" style=" background-color:#42313A; vertical-align: bottom;">
                <!--review-->
                
                <section>
<p style="color:white; display:hidden;" id="instruction_add">Click on a title to add a book to the database!"</p>
                    <pre style="display:none; color:white; background-color:#9f4636;" id="book_reviews"></pre>
                </section>
            </div>
            <!--Col end-->
          
            
        </div>
        <!--row end-->
     
    </div>
    <!--Container end-->
</div> <!-- search end -->

<div id="viewBook" class="w3-container city" style="display:none"> <!-- START VIEW -->
      <div class="container-fluid" style="margin-left:20px; margin-right:20px; min-width:450px;">
        <!-- Book title and author fields and buttons for add and search-->

        <div class="row" style=" background-color:#42313A; min-height:25em;">

            <div class="col-lg-5 col-md-12 col-sm-12" style=" background-color:#6c2d2c; vertical-align: bottom; min-height:25em;">
                <h2 style="border-radius: 8px; color:white; padding:5px; height:2em; background-color:#6c2d2c;">View saved books</h2>
                <h5 style="color:white;">If you are unsure about a title or author, search in Googles book database. <br>Specify title or author (or both) and press the search button. </h5>
                
                <button type="button" class="btn-success btn-sm" id='button2'>VIEW</button>

                <button type="button" class="btn-danger btn-sm" id='delete'>DELETE</button>
              
            </div>
            <!--Col end-->
            
            <div class="col-lg-7 col-md-12 col-sm-12" style=" background-color:#42313A; vertical-align: bottom; ">
                <!--View-->
                <br>
                <div class="col-lg-12" style="vertical-align: bottom; height: 100%;">
                    
                        <ul class="list-group" id="books" style="padding:9.5px; display:none;"></ul>
                </div>
            </div>
            <!--Col end-->
            
        </div>
        <!--row end-->
     
    </div>
    <!--Container end-->
</div> <!--view end -->



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

</body>

</html>
