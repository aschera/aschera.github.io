<!DOCTYPE html>
<html lang="en">
<!-- #729f98 green    #283018 darkgreen     #aa863a orange -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>innl√§mning 2</title>
    
    <!-- Bootstrap core CSS -->
    <link href="../../dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="grid.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="../../assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    
    <script src='https://cdn.firebase.com/js/client/2.4.0/firebase.js'></script>
    
    <script src="script.js"></script>
    
    <link href="style.css" rel="stylesheet">
    
    <style>
        label {color:white;}
        
        #text {display:none;}
        #results {display:none;}
        #post {display:none;}
        
    </style>
</head>

<body style="margin-left:20px; margin-right:20px; ">
<div class="container">

      <div class="page-header">
        <h1>Chatapp</h1>
        <p class="lead">Do you want to talk?</p>
      </div>

    
      <div class="row" style="background-color:#729f98; padding:1em;">
        <div class="col-md-4" style="background-color:#283018; padding:1em; margin:1em;" >
            <input id="username" type="text" placeholder="Name">
            <button id="OK">Log In</button>
            <br/>
            
            
            <label>
 <input type="checkbox" onclick="saveData()";>
  I want to save this username for later.
</label>
            <br><br>
            <br/>
            <br><br>
            <input id="text" type="text" placeholder="Message"><br/>

            <button id="post">Post</button><br/>
          
        </div>
        <div class="col-md-4">
    
            <div id="results"></div>
          
        </div>
      </div>

</div>  <!-- end container -->
 
    
<script>
    var myFirebase = new Firebase('https://mein-chat.firebaseio.com/');
</script>
       <script>
    var myFirebase = new Firebase('https://mein-chat.firebaseio.com/');
    var usernameInput = document.querySelector('#username');
    var textInput = document.querySelector('#text');
    var postButton = document.querySelector('#post');

    postButton.addEventListener("click", function() {
      var msgUser = usernameInput.value;
      var msgText = textInput.value;
      myFirebase.push({username:msgUser, text:msgText});
      textInput.value = "";
    });
    var startListening = function() {
      myFirebase.on('child_added', function(snapshot) {
        var msg = snapshot.val();
      
        //name
        var msgUsernameElement = document.createElement("strong");
        msgUsernameElement.textContent = msg.username + ' wrote: ';
        
        //message
        var msgTextElement = document.createElement("p");
        msgTextElement.textContent = msg.text;
  
        //box t hold the name and message
        var msgElement = document.createElement("div");
        msgElement.appendChild(msgUsernameElement);
        msgElement.appendChild(msgTextElement);
          
          
        msgElement.className = "msg";
        document.getElementById("results").appendChild(msgElement);
      });
    }

    // Begin listening for data
    startListening();

</script>

    <script>

        // Read value from storage, or empty array
        names = JSON.parse(localStorage.getItem('locname') || "[]");

        var saveData = function() {
            
            var data = document.getElementById('username').value;
      
        //unique ID for the user
        let id = data.length + 'id' + Math.floor((Math.random() * 100) + 1) + data;  
     
          names.push({id: id, name: data});
            
          localStorage.setItem('locname', JSON.stringify(names));
            
            console.log(names);
        }

      

    </script>
</body>

</html>
